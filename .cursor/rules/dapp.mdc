---
globs: kit/dapp/**/*
description: React 19 dApp - TanStack, oRPC, Drizzle, Tailwind v4
---

# React 19 dApp Module

## Stack

- **Core**: React 19 | TanStack (Start/Query/Form/Router) | oRPC | Drizzle
- **Styling**: Tailwind v4 | shadcn/ui
- **Build**: Vite | Vitest

## Key Commands

```bash
bun run dev                    # Start dev server (port 3000)
bun run codegen                # After API changes
bun run test                   # Unit tests (Vitest)
bun run test:integration       # Integration tests
```

## Architecture

```
src/
  components/ui/               # shadcn - DO NOT MODIFY
  routes/                      # File-based routing
  orpc/                        # API layer
  lib/auth/                    # Authentication
  hooks/                       # Custom React hooks
```

## Critical Patterns

### Data Fetching

- Use React Query for server state
- NEVER copy server state to local state
- Use suspense boundaries

### Forms

- TanStack Form + Zod validators
- Server-side validation in oRPC
- Optimistic updates with React Query

### Components

- shadcn pattern (no forwardRef)
- Compound components for complex UI
- Strict TypeScript types

## Testing

```javascript
// Component tests (default)
// Uses happy-dom environment

// Server/API tests
// @vitest-environment node
```

## Performance

- React Compiler optimizations
- Route-based code splitting
- Suspense boundaries
- Server Components where possible

## Common Issues

1. Use `bun run test` NOT `bun test`
2. DO NOT modify `src/components/ui/*`
3. Use React Query state, no duplication
4. Add `@vitest-environment node` for server code
5. Run `bun run codegen` after API changes
